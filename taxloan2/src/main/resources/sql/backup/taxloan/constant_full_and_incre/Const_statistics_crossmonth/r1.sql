




select
    r1_1.mcht_cd,
    r1_1.month,
    r1_1.invoice_sc_cnt_l3m,
    r1_1.invoice_sc_cancel_cnt_l3m,
    r1_1.invoice_sc_red_cnt_l3m,
    r1_1.invoice_sc_total_sum_l3m,
    r1_1.invoice_cnt_l3m,
    r1_1.invoice_cr_cnt_l3m,
    r1_1.invoice_c_all_cnt_l3m,
    r1_1.invoice_r_all_cnt_l3m,
    r1_1.invoice_total_sum_l3m,
    r1_1.invoice_total_r_sum_l3m,
    r1_1.invoice_total_c_sum_l3m,
    r1_1.invoice_s_cnt_l3m,
    r1_1.invoice_s_cancel_cnt_l3m,
    r1_1.invoice_s_red_cnt_l3m,
    r1_1.invoice_s_total_sum_l3m,
    r1_1.invoice_c_cnt_l3m,
    r1_1.invoice_c_cancel_cnt_l3m,
    r1_1.invoice_c_red_cnt_l3m,
    r1_1.invoice_c_total_sum_l3m,
    r1_1.invoice_t_cnt_l3m,
    r1_1.invoice_t_cancel_cnt_l3m,
    r1_1.invoice_t_red_cnt_l3m,
    r1_1.invoice_t_total_sum_l3m,
    r1_1.invoice_p_cnt_l3m,
    r1_1.invoice_p_cancel_cnt_l3m,
    r1_1.invoice_p_red_cnt_l3m,
    r1_1.invoice_p_total_sum_l3m,
    r1_1.invoice_e_cnt_l3m,
    r1_1.invoice_e_cancel_cnt_l3m,
    r1_1.invoice_e_red_cnt_l3m,
    r1_1.invoice_e_total_sum_l3m,
    r1_1.invoice_r_cnt_l3m,
    r1_1.invoice_r_cancel_cnt_l3m,
    r1_1.invoice_r_red_cnt_l3m,
    r1_1.invoice_r_total_sum_l3m,
    r1_1.invoice_lt100_cnt_l3m,
    r1_1.invoice_lt100_cr_cnt_l3m,
    r1_1.invoice_lt100_total_sum_l3m,
    r1_1.invoice_lt1000_cnt_l3m,
    r1_1.invoice_lt1000_cr_cnt_l3m,
    r1_1.invoice_lt1000_total_sum_l3m,
    r1_1.invoice_lt2500_cnt_l3m,
    r1_1.invoice_lt2500_cr_cnt_l3m,
    r1_1.invoice_lt2500_total_sum_l3m,
    r1_1.invoice_lt5000_cnt_l3m,
    r1_1.invoice_lt5000_cr_cnt_l3m,
    r1_1.invoice_lt5000_total_sum_l3m,
    r1_1.invoice_lt10000_cnt_l3m,
    r1_1.invoice_lt10000_cr_cnt_l3m,
    r1_1.invoice_lt10000_total_sum_l3m,
    r1_1.invoice_gt10000_cnt_l3m,
    r1_1.invoice_gt10000_cr_cnt_l3m,
    r1_1.invoice_gt10000_total_sum_l3m,
    r1_1.invoice_detail_cnt_l3m,
    r1_1.invoice_detail_cr_cnt_l3m,
    r1_1.invoice_detail_total_sum_l3m,
    r1_1.invoice_sc_cnt_l6m,
    r1_1.invoice_sc_cancel_cnt_l6m,
    r1_1.invoice_sc_red_cnt_l6m,
    r1_1.invoice_sc_total_sum_l6m,
    r1_1.invoice_cnt_l6m,
    r1_1.invoice_cr_cnt_l6m,
    r1_1.invoice_c_all_cnt_l6m,
    r1_1.invoice_r_all_cnt_l6m,
    r1_1.invoice_total_sum_l6m,
    r1_1.invoice_total_r_sum_l6m,
    r1_1.invoice_total_c_sum_l6m,
    r1_1.invoice_s_cnt_l6m,
    r1_1.invoice_s_cancel_cnt_l6m,
    r1_1.invoice_s_red_cnt_l6m,
    r1_1.invoice_s_total_sum_l6m,
    r1_1.invoice_c_cnt_l6m,
    r1_1.invoice_c_cancel_cnt_l6m,
    r1_1.invoice_c_red_cnt_l6m,
    r1_1.invoice_c_total_sum_l6m,
    r1_1.invoice_t_cnt_l6m,
    r1_1.invoice_t_cancel_cnt_l6m,
    r1_1.invoice_t_red_cnt_l6m,
    r1_1.invoice_t_total_sum_l6m,
    r1_1.invoice_p_cnt_l6m,
    r1_1.invoice_p_cancel_cnt_l6m,
    r1_1.invoice_p_red_cnt_l6m,
    r1_1.invoice_p_total_sum_l6m,
    r1_1.invoice_e_cnt_l6m,
    r1_1.invoice_e_cancel_cnt_l6m,
    r1_1.invoice_e_red_cnt_l6m,
    r1_1.invoice_e_total_sum_l6m,
    r1_1.invoice_r_cnt_l6m,
    r1_1.invoice_r_cancel_cnt_l6m,
    r1_1.invoice_r_red_cnt_l6m,
    r1_1.invoice_r_total_sum_l6m,
    r1_1.invoice_lt100_cnt_l6m,
    r1_1.invoice_lt100_cr_cnt_l6m,
    r1_1.invoice_lt100_total_sum_l6m,
    r1_1.invoice_lt1000_cnt_l6m,
    r1_1.invoice_lt1000_cr_cnt_l6m,
    r1_1.invoice_lt1000_total_sum_l6m,
    r1_1.invoice_lt2500_cnt_l6m,
    r1_1.invoice_lt2500_cr_cnt_l6m,
    r1_1.invoice_lt2500_total_sum_l6m,
    r1_1.invoice_lt5000_cnt_l6m,
    r1_1.invoice_lt5000_cr_cnt_l6m,
    r1_1.invoice_lt5000_total_sum_l6m,
    r1_1.invoice_lt10000_cnt_l6m,
    r1_1.invoice_lt10000_cr_cnt_l6m,
    r1_1.invoice_lt10000_total_sum_l6m,
    r1_1.invoice_gt10000_cnt_l6m,
    r1_1.invoice_gt10000_cr_cnt_l6m,
    r1_1.invoice_gt10000_total_sum_l6m,
    r1_1.invoice_detail_cnt_l6m,
    r1_1.invoice_detail_cr_cnt_l6m,
    r1_1.invoice_detail_total_sum_l6m,

    r1_2.invoice_sc_cnt_l12m,
    r1_2.invoice_sc_cancel_cnt_l12m,
    r1_2.invoice_sc_red_cnt_l12m,
    r1_2.invoice_sc_total_sum_l12m,
    r1_2.invoice_cnt_l12m,
    r1_2.invoice_cr_cnt_l12m,
    r1_2.invoice_c_all_cnt_l12m,
    r1_2.invoice_r_all_cnt_l12m,
    r1_2.invoice_total_sum_l12m,
    r1_2.invoice_total_r_sum_l12m,
    r1_2.invoice_total_c_sum_l12m,
    r1_2.invoice_s_cnt_l12m,
    r1_2.invoice_s_cancel_cnt_l12m,
    r1_2.invoice_s_red_cnt_l12m,
    r1_2.invoice_s_total_sum_l12m,
    r1_2.invoice_c_cnt_l12m,
    r1_2.invoice_c_cancel_cnt_l12m,
    r1_2.invoice_c_red_cnt_l12m,
    r1_2.invoice_c_total_sum_l12m,
    r1_2.invoice_t_cnt_l12m,
    r1_2.invoice_t_cancel_cnt_l12m,
    r1_2.invoice_t_red_cnt_l12m,
    r1_2.invoice_t_total_sum_l12m,
    r1_2.invoice_p_cnt_l12m,
    r1_2.invoice_p_cancel_cnt_l12m,
    r1_2.invoice_p_red_cnt_l12m,
    r1_2.invoice_p_total_sum_l12m,
    r1_2.invoice_e_cnt_l12m,
    r1_2.invoice_e_cancel_cnt_l12m,
    r1_2.invoice_e_red_cnt_l12m,
    r1_2.invoice_e_total_sum_l12m,
    r1_2.invoice_r_cnt_l12m,
    r1_2.invoice_r_cancel_cnt_l12m,
    r1_2.invoice_r_red_cnt_l12m,
    r1_2.invoice_r_total_sum_l12m,
    r1_2.invoice_lt100_cnt_l12m,
    r1_2.invoice_lt100_cr_cnt_l12m,
    r1_2.invoice_lt100_total_sum_l12m,
    r1_2.invoice_lt1000_cnt_l12m,
    r1_2.invoice_lt1000_cr_cnt_l12m,
    r1_2.invoice_lt1000_total_sum_l12m,
    r1_2.invoice_lt2500_cnt_l12m,
    r1_2.invoice_lt2500_cr_cnt_l12m,
    r1_2.invoice_lt2500_total_sum_l12m,
    r1_2.invoice_lt5000_cnt_l12m,
    r1_2.invoice_lt5000_cr_cnt_l12m,
    r1_2.invoice_lt5000_total_sum_l12m,
    r1_2.invoice_lt10000_cnt_l12m,
    r1_2.invoice_lt10000_cr_cnt_l12m,
    r1_2.invoice_lt10000_total_sum_l12m,
    r1_2.invoice_gt10000_cnt_l12m,
    r1_2.invoice_gt10000_cr_cnt_l12m,
    r1_2.invoice_gt10000_total_sum_l12m,
    r1_2.invoice_detail_cnt_l12m,
    r1_2.invoice_detail_cr_cnt_l12m,
    r1_2.invoice_detail_total_sum_l12m,
    r1_2.invoice_sc_cnt_l24m,
    r1_2.invoice_sc_cancel_cnt_l24m,
    r1_2.invoice_sc_red_cnt_l24m,
    r1_2.invoice_sc_total_sum_l24m,
    r1_2.invoice_cnt_l24m,
    r1_2.invoice_cr_cnt_l24m,
    r1_2.invoice_c_all_cnt_l24m,
    r1_2.invoice_r_all_cnt_l24m,
    r1_2.invoice_total_sum_l24m,
    r1_2.invoice_total_r_sum_l24m,
    r1_2.invoice_total_c_sum_l24m,
    r1_2.invoice_s_cnt_l24m,
    r1_2.invoice_s_cancel_cnt_l24m,
    r1_2.invoice_s_red_cnt_l24m,
    r1_2.invoice_s_total_sum_l24m,
    r1_2.invoice_c_cnt_l24m,
    r1_2.invoice_c_cancel_cnt_l24m,
    r1_2.invoice_c_red_cnt_l24m,
    r1_2.invoice_c_total_sum_l24m,
    r1_2.invoice_t_cnt_l24m,
    r1_2.invoice_t_cancel_cnt_l24m,
    r1_2.invoice_t_red_cnt_l24m,
    r1_2.invoice_t_total_sum_l24m,
    r1_2.invoice_p_cnt_l24m,
    r1_2.invoice_p_cancel_cnt_l24m,
    r1_2.invoice_p_red_cnt_l24m,
    r1_2.invoice_p_total_sum_l24m,
    r1_2.invoice_e_cnt_l24m,
    r1_2.invoice_e_cancel_cnt_l24m,
    r1_2.invoice_e_red_cnt_l24m,
    r1_2.invoice_e_total_sum_l24m,
    r1_2.invoice_r_cnt_l24m,
    r1_2.invoice_r_cancel_cnt_l24m,
    r1_2.invoice_r_red_cnt_l24m,
    r1_2.invoice_r_total_sum_l24m,
    r1_2.invoice_lt100_cnt_l24m,
    r1_2.invoice_lt100_cr_cnt_l24m,
    r1_2.invoice_lt100_total_sum_l24m,
    r1_2.invoice_lt1000_cnt_l24m,
    r1_2.invoice_lt1000_cr_cnt_l24m,
    r1_2.invoice_lt1000_total_sum_l24m,
    r1_2.invoice_lt2500_cnt_l24m,
    r1_2.invoice_lt2500_cr_cnt_l24m,
    r1_2.invoice_lt2500_total_sum_l24m,
    r1_2.invoice_lt5000_cnt_l24m,
    r1_2.invoice_lt5000_cr_cnt_l24m,
    r1_2.invoice_lt5000_total_sum_l24m,
    r1_2.invoice_lt10000_cnt_l24m,
    r1_2.invoice_lt10000_cr_cnt_l24m,
    r1_2.invoice_lt10000_total_sum_l24m,
    r1_2.invoice_gt10000_cnt_l24m,
    r1_2.invoice_gt10000_cr_cnt_l24m,
    r1_2.invoice_gt10000_total_sum_l24m,
    r1_2.invoice_detail_cnt_l24m,
    r1_2.invoice_detail_cr_cnt_l24m,
    r1_2.invoice_detail_total_sum_l24m,
    r1_2.invoice_r_all_cnt_l712m,
    r1_2.invoice_c_all_cnt_l712m,

    -- 计算累计交易对手数，按照交易对手号去重
    r1_4.buyer_cnt_l3m,
    r1_4.buyer_cnt_l6m,
    r1_4.buyer_cnt_l12m,
    r1_4.buyer_cnt_l24m,
    r1_4.buyer_cnt_l712m,
    r1_4.buyer_cnt_l1324m,

    r1_2.invoice_r_all_cnt_l1324m,
    r1_2.invoice_c_all_cnt_l1324m,

    r1_2.invoice_cnt_l712m,
    r1_2.invoice_cnt_l1324m

from r1_1
left join r1_2
on
    r1_1.mcht_cd=r1_2.mcht_cd and r1_1.month=r1_2.month
left join r1_4
on
    r1_4.sellertaxno=r1_2.mcht_cd and r1_4.month_a=r1_2.month

