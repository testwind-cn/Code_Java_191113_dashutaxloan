insert overwrite table ${hivevar:DATABASE_DEST}.statistics_crossmonth_incre
select mcht_cd,
       data_month,
       invoice_sc_cnt_l3m,
       invoice_sc_cancel_cnt_l3m,
       invoice_sc_red_cnt_l3m,
       invoice_sc_total_sum_l3m,
       invoice_cnt_l3m,
       invoice_cr_cnt_l3m,
       invoice_total_sum_l3m,
       invoice_s_cnt_l3m,
       invoice_s_cancel_cnt_l3m,
       invoice_s_red_cnt_l3m,
       invoice_s_total_sum_l3m,
       invoice_c_cnt_l3m,
       invoice_c_cancel_cnt_l3m,
       invoice_c_red_cnt_l3m,
       invoice_c_total_sum_l3m,
       invoice_t_cnt_l3m,
       invoice_t_cancel_cnt_l3m,
       invoice_t_red_cnt_l3m,
       invoice_t_total_sum_l3m,
       invoice_p_cnt_l3m,
       invoice_p_cancel_cnt_l3m,
       invoice_p_red_cnt_l3m,
       invoice_p_total_sum_l3m,
       invoice_e_cnt_l3m,
       invoice_e_cancel_cnt_l3m,
       invoice_e_red_cnt_l3m,
       invoice_e_total_sum_l3m,
       invoice_r_cnt_l3m,
       invoice_r_cancel_cnt_l3m,
       invoice_r_red_cnt_l3m,
       invoice_r_total_sum_l3m,
       invoice_red_cnt_rate_l3m,
       invoice_cancel_cnt_rate_l3m,
       invoice_red_total_sum_rate_l3m,
       invoice_cancel_total_sum_rate_l3m,
       invoice_lt100_cnt_l3m,
       invoice_lt100_cr_cnt_l3m,
       invoice_lt100_total_sum_l3m,
       invoice_lt1000_cnt_l3m,
       invoice_lt1000_cr_cnt_l3m,
       invoice_lt1000_total_sum_l3m,
       invoice_lt2500_cnt_l3m,
       invoice_lt2500_cr_cnt_l3m,
       invoice_lt2500_total_sum_l3m,
       invoice_lt5000_cnt_l3m,
       invoice_lt5000_cr_cnt_l3m,
       invoice_lt5000_total_sum_l3m,
       invoice_lt10000_cnt_l3m,
       invoice_lt10000_cr_cnt_l3m,
       invoice_lt10000_total_sum_l3m,
       invoice_gt10000_cnt_l3m,
       invoice_gt10000_cr_cnt_l3m,
       invoice_gt10000_total_sum_l3m,
       invoice_detail_cnt_l3m,
       invoice_detail_cr_cnt_l3m,
       invoice_detail_total_sum_l3m,
       buyer_cnt_l3m,
       invoice_sc_cnt_l6m,
       invoice_sc_cancel_cnt_l6m,
       invoice_sc_red_cnt_l6m,
       invoice_sc_total_sum_l6m,
       invoice_cnt_l6m,
       invoice_cr_cnt_l6m,
       invoice_total_sum_l6m,
       invoice_s_cnt_l6m,
       invoice_s_cancel_cnt_l6m,
       invoice_s_red_cnt_l6m,
       invoice_s_total_sum_l6m,
       invoice_c_cnt_l6m,
       invoice_c_cancel_cnt_l6m,
       invoice_c_red_cnt_l6m,
       invoice_c_total_sum_l6m,
       invoice_t_cnt_l6m,
       invoice_t_cancel_cnt_l6m,
       invoice_t_red_cnt_l6m,
       invoice_t_total_sum_l6m,
       invoice_p_cnt_l6m,
       invoice_p_cancel_cnt_l6m,
       invoice_p_red_cnt_l6m,
       invoice_p_total_sum_l6m,
       invoice_e_cnt_l6m,
       invoice_e_cancel_cnt_l6m,
       invoice_e_red_cnt_l6m,
       invoice_e_total_sum_l6m,
       invoice_r_cnt_l6m,
       invoice_r_cancel_cnt_l6m,
       invoice_r_red_cnt_l6m,
       invoice_r_total_sum_l6m,
       invoice_red_cnt_rate_l6m,
       invoice_cancel_cnt_rate_l6m,
       invoice_red_total_sum_rate_l6m,
       invoice_cancel_total_sum_rate_l6m,
       invoice_lt100_cnt_l6m,
       invoice_lt100_cr_cnt_l6m,
       invoice_lt100_total_sum_l6m,
       invoice_lt1000_cnt_l6m,
       invoice_lt1000_cr_cnt_l6m,
       invoice_lt1000_total_sum_l6m,
       invoice_lt2500_cnt_l6m,
       invoice_lt2500_cr_cnt_l6m,
       invoice_lt2500_total_sum_l6m,
       invoice_lt5000_cnt_l6m,
       invoice_lt5000_cr_cnt_l6m,
       invoice_lt5000_total_sum_l6m,
       invoice_lt10000_cnt_l6m,
       invoice_lt10000_cr_cnt_l6m,
       invoice_lt10000_total_sum_l6m,
       invoice_gt10000_cnt_l6m,
       invoice_gt10000_cr_cnt_l6m,
       invoice_gt10000_total_sum_l6m,
       invoice_detail_cnt_l6m,
       invoice_detail_cr_cnt_l6m,
       invoice_detail_total_sum_l6m,
       buyer_cnt_l6m,
       buyer_a_invoice_cnt_l6m,
       buyer_b_invoice_cnt_l6m,
       buyer_c_invoice_cnt_l6m,
       buyer_f_invoice_cnt_l6m,
       buyer_a_amt_sum_l6m,
       buyer_b_amt_sum_l6m,
       buyer_c_amt_sum_l6m,
       buyer_f_amt_sum_l6m,
       invoice_sc_cnt_l12m,
       invoice_sc_cancel_cnt_l12m,
       invoice_sc_red_cnt_l12m,
       invoice_sc_total_sum_l12m,
       invoice_cnt_l12m,
       invoice_cr_cnt_l12m,
       invoice_total_sum_l12m,
       invoice_s_cnt_l12m,
       invoice_s_cancel_cnt_l12m,
       invoice_s_red_cnt_l12m,
       invoice_s_total_sum_l12m,
       invoice_c_cnt_l12m,
       invoice_c_cancel_cnt_l12m,
       invoice_c_red_cnt_l12m,
       invoice_c_total_sum_l12m,
       invoice_t_cnt_l12m,
       invoice_t_cancel_cnt_l12m,
       invoice_t_red_cnt_l12m,
       invoice_t_total_sum_l12m,
       invoice_p_cnt_l12m,
       invoice_p_cancel_cnt_l12m,
       invoice_p_red_cnt_l12m,
       invoice_p_total_sum_l12m,
       invoice_e_cnt_l12m,
       invoice_e_cancel_cnt_l12m,
       invoice_e_red_cnt_l12m,
       invoice_e_total_sum_l12m,
       invoice_r_cnt_l12m,
       invoice_r_cancel_cnt_l12m,
       invoice_r_red_cnt_l12m,
       invoice_r_total_sum_l12m,
       invoice_red_cnt_rate_l12m,
       invoice_cancel_cnt_rate_l12m,
       invoice_red_total_sum_rate_l12m,
       invoice_cancel_total_sum_rate_l12m,
       invoice_lt100_cnt_l12m,
       invoice_lt100_cr_cnt_l12m,
       invoice_lt100_total_sum_l12m,
       invoice_lt1000_cnt_l12m,
       invoice_lt1000_cr_cnt_l12m,
       invoice_lt1000_total_sum_l12m,
       invoice_lt2500_cnt_l12m,
       invoice_lt2500_cr_cnt_l12m,
       invoice_lt2500_total_sum_l12m,
       invoice_lt5000_cnt_l12m,
       invoice_lt5000_cr_cnt_l12m,
       invoice_lt5000_total_sum_l12m,
       invoice_lt10000_cnt_l12m,
       invoice_lt10000_cr_cnt_l12m,
       invoice_lt10000_total_sum_l12m,
       invoice_gt10000_cnt_l12m,
       invoice_gt10000_cr_cnt_l12m,
       invoice_gt10000_total_sum_l12m,
       invoice_detail_cnt_l12m,
       invoice_detail_cr_cnt_l12m,
       invoice_detail_total_sum_l12m,
       buyer_cnt_l12m,
       buyer_a_invoice_cnt_l12m,
       buyer_b_invoice_cnt_l12m,
       buyer_c_invoice_cnt_l12m,
       buyer_f_invoice_cnt_l12m,
       buyer_a_amt_sum_l12m,
       buyer_b_amt_sum_l12m,
       buyer_c_amt_sum_l12m,
       buyer_f_amt_sum_l12m,
       invoice_sc_cnt_l24m,
       invoice_sc_cancel_cnt_l24m,
       invoice_sc_red_cnt_l24m,
       invoice_sc_total_sum_l24m,
       invoice_cnt_l24m,
       invoice_cr_cnt_l24m,
       invoice_total_sum_l24m,
       invoice_s_cnt_l24m,
       invoice_s_cancel_cnt_l24m,
       invoice_s_red_cnt_l24m,
       invoice_s_total_sum_l24m,
       invoice_c_cnt_l24m,
       invoice_c_cancel_cnt_l24m,
       invoice_c_red_cnt_l24m,
       invoice_c_total_sum_l24m,
       invoice_t_cnt_l24m,
       invoice_t_cancel_cnt_l24m,
       invoice_t_red_cnt_l24m,
       invoice_t_total_sum_l24m,
       invoice_p_cnt_l24m,
       invoice_p_cancel_cnt_l24m,
       invoice_p_red_cnt_l24m,
       invoice_p_total_sum_l24m,
       invoice_e_cnt_l24m,
       invoice_e_cancel_cnt_l24m,
       invoice_e_red_cnt_l24m,
       invoice_e_total_sum_l24m,
       invoice_r_cnt_l24m,
       invoice_r_cancel_cnt_l24m,
       invoice_r_red_cnt_l24m,
       invoice_r_total_sum_l24m,
       invoice_red_cnt_rate_l24m,
       invoice_cancel_cnt_rate_l24m,
       invoice_red_total_sum_rate_l24m,
       invoice_cancel_total_sum_rate_l24m,
       invoice_lt100_cnt_l24m,
       invoice_lt100_cr_cnt_l24m,
       invoice_lt100_total_sum_l24m,
       invoice_lt1000_cnt_l24m,
       invoice_lt1000_cr_cnt_l24m,
       invoice_lt1000_total_sum_l24m,
       invoice_lt2500_cnt_l24m,
       invoice_lt2500_cr_cnt_l24m,
       invoice_lt2500_total_sum_l24m,
       invoice_lt5000_cnt_l24m,
       invoice_lt5000_cr_cnt_l24m,
       invoice_lt5000_total_sum_l24m,
       invoice_lt10000_cnt_l24m,
       invoice_lt10000_cr_cnt_l24m,
       invoice_lt10000_total_sum_l24m,
       invoice_gt10000_cnt_l24m,
       invoice_gt10000_cr_cnt_l24m,
       invoice_gt10000_total_sum_l24m,
       invoice_detail_cnt_l24m,
       invoice_detail_cr_cnt_l24m,
       invoice_detail_total_sum_l24m,
       buyer_cnt_l24m,
       buyer_a_invoice_cnt_l24m,
       buyer_b_invoice_cnt_l24m,
       buyer_c_invoice_cnt_l24m,
       buyer_f_invoice_cnt_l24m,
       buyer_a_amt_sum_l24m,
       buyer_b_amt_sum_l24m,
       buyer_c_amt_sum_l24m,
       buyer_f_amt_sum_l24m,
       invoice_sc_cnt_ratio_6m,
       invoice_sc_cancel_cnt_ratio_6m,
       invoice_sc_red_cnt_ratio_6m,
       invoice_sc_total_sum_ratio_6m,
       invoice_cnt_ratio_6m,
       invoice_total_sum_ratio_6m,
       invoice_s_cnt_ratio_6m,
       invoice_s_total_sum_ratio_6m,
       invoice_c_cnt_ratio_6m,
       invoice_c_total_sum_ratio_6m,
       invoice_t_cnt_ratio_6m,
       invoice_t_total_sum_ratio_6m,
       invoice_p_cnt_ratio_6m,
       invoice_p_total_sum_ratio_6m,
       invoice_e_cnt_ratio_6m,
       invoice_e_total_sum_ratio_6m,
       invoice_r_cnt_ratio_6m,
       invoice_r_total_sum_ratio_6m,
       invoice_red_cnt_rate_ratio_6m,
       invoice_cancel_cnt_rate_ratio_6m,
       invoice_red_total_sum_rate_ratio_6m,
       invoice_cancel_total_sum_rate_ratio_6m,
       invoice_lt100_cnt_ratio_6m,
       invoice_lt100_total_sum_ratio_6m,
       invoice_lt1000_cnt_ratio_6m,
       invoice_lt1000_total_sum_ratio_6m,
       invoice_lt2500_cnt_ratio_6m,
       invoice_lt2500_total_sum_ratio_6m,
       invoice_lt5000_cnt_ratio_6m,
       invoice_lt5000_total_sum_ratio_6m,
       invoice_gt10000_cnt_ratio_6m,
       invoice_gt10000_total_sum_ratio_6m,
       invoice_detail_cnt_ratio_6m,
       invoice_detail_total_sum_ratio_6m,
       buyer_cnt_chg_rate_6m,
       buyer_a_cnt_chg_rate_6m,
       buyer_b_cnt_chg_rate_6m,
       buyer_c_cnt_chg_rate_6m,
       buyer_f_cnt_chg_rate_6m,
       buyer_a_invoice_cnt_l12m_chg_rate_6m,
       buyer_b_invoice_cnt_l12m_chg_rate_6m,
       buyer_c_invoice_cnt_l12m_chg_rate_6m,
       buyer_f_invoice_cnt_l12m_chg_rate_6m,
       buyer_a_amt_sum_l12m_chg_rate_6m,
       buyer_b_amt_sum_l12m_chg_rate_6m,
       buyer_c_amt_sum_l12m_chg_rate_6m,
       buyer_f_amt_sum_l12m_chg_rate_6m,
       invoice_sc_cnt_ratio_12m,
       invoice_sc_cancel_cnt_ratio_12m,
       invoice_sc_red_cnt_ratio_12m,
       invoice_sc_total_sum_ratio_12m,
       invoice_cnt_ratio_12m,
       invoice_total_sum_ratio_12m,
       invoice_s_cnt_ratio_12m,
       invoice_s_total_sum_ratio_12m,
       invoice_c_cnt_ratio_12m,
       invoice_c_total_sum_ratio_12m,
       invoice_t_cnt_ratio_12m,
       invoice_t_total_sum_ratio_12m,
       invoice_p_cnt_ratio_12m,
       invoice_p_total_sum_ratio_12m,
       invoice_e_cnt_ratio_12m,
       invoice_e_total_sum_ratio_12m,
       invoice_r_cnt_ratio_12m,
       invoice_r_total_sum_ratio_12m,
       invoice_red_cnt_rate_ratio_12m,
       invoice_cancel_cnt_rate_ratio_12m,
       invoice_red_total_sum_rate_ratio_12m,
       invoice_cancel_total_sum_rate_ratio_12m,
       invoice_lt100_cnt_ratio_12m,
       invoice_lt100_total_sum_ratio_12m,
       invoice_lt1000_cnt_ratio_12m,
       invoice_lt1000_total_sum_ratio_12m,
       invoice_lt2500_cnt_ratio_12m,
       invoice_lt2500_total_sum_ratio_12m,
       invoice_lt5000_cnt_ratio_12m,
       invoice_lt5000_total_sum_ratio_12m,
       invoice_gt10000_cnt_ratio_12m,
       invoice_gt10000_total_sum_ratio_12m,
       invoice_detail_cnt_ratio_12m,
       invoice_detail_total_sum_ratio_12m,
       buyer_cnt_chg_rate_12m,
       buyer_a_cnt_chg_rate_12m,
       buyer_b_cnt_chg_rate_12m,
       buyer_c_cnt_chg_rate_12m,
       buyer_f_cnt_chg_rate_12m,
       buyer_a_invoice_cnt_l12m_chg_rate_12m,
       buyer_b_invoice_cnt_l12m_chg_rate_12m,
       buyer_c_invoice_cnt_l12m_chg_rate_12m,
       buyer_f_invoice_cnt_l12m_chg_rate_12m,
       buyer_a_amt_sum_l12m_chg_rate_12m,
       buyer_b_amt_sum_l12m_chg_rate_12m,
       buyer_c_amt_sum_l12m_chg_rate_12m,
       buyer_f_amt_sum_l12m_chg_rate_12m,
       is_delete,
       create_time,
       create_user,
       modify_time,
       modify_user
from ${hivevar:DATABASE_DEST}.statistics_crossmonth e,
(
    select
        table_name,
        max(export_date) as last_export_date
    from
         ${hivevar:DATABASE_DEST}.control_table
    where table_name = 'statistics_crossmonth'
    group by table_name
) c
where
    e.create_time >= current_date()
    and e.modify_time > c.last_export_date
   